from kedro.pipeline import Pipeline, node
from .nodes import preprocess_images_with_label_classification, build_dataset_with_processed_images

def create_pipeline(**kwargs):
    return Pipeline(
        [
            node(
                func=preprocess_images_with_label_classification,
                inputs="benign_images_from_files",
                outputs="pre_processed_cnn_images",
                name="preprocess_cnn_images_node",
            ),
            node(
                func=build_dataset_with_processed_images,
                inputs="pre_processed_cnn_images",
                outputs="labeled_cnn_images",
                name="dataset_creation_cnn_images_node",
            ),
        ]
    )