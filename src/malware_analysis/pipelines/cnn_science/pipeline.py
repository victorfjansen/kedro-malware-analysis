from kedro.pipeline import Pipeline, node
from .nodes import get_cnn_data_loader, create_model, initialize_training

def create_pipeline(**kwargs):
    return Pipeline(
        [
            node(
                func=get_cnn_data_loader,
                inputs="labeled_cnn_images",
                outputs=["cnn_train_loader", "cnn_test_loader"],
                name="cnn_dataset_loader_builder",
            ),
            node(
                func=create_model,
                inputs="labels_cnn_set",
                outputs="cnn_model",
                name="cnn_model_builder",
            ),
            node(
                func=initialize_training,
                inputs=["cnn_model_builder", "cnn_train_loader", "cnn_test_loader"],
                outputs=["cnn_testing_metrics", "cnn_training_metrics"],
                name="cnn_trainer",
            ),
        ]
    )