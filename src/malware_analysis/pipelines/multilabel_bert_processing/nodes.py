import pandas as pd

def preprocess_multilabel_mnemonic_codes(benign_most_common_mnemonic_files, malign_multilabel_mnemonic_files):
    df1 = benign_most_common_mnemonic_files
    df2 = malign_multilabel_mnemonic_files

    merged_df = pd.concat([df1, df2], ignore_index=True)
    cleaned_df = merged_df[merged_df['opcodes'].str.strip() != ""]
    shuffled_df = cleaned_df.sample(frac=1).reset_index(drop=True)

    unique_types = shuffled_df['type'].unique()
    type_to_label = {t: i for i, t in enumerate(unique_types)}
    
    return shuffled_df, type_to_label
